/**
 * Настраивает права доступа пользователя на основе DTO
 *
 * @param entity Сущность пользователя
 * @param dto DTO с данными пользователя
 */
private void setupUserPermissions(UsersEntity entity, UsersCreateDto dto) {
    // Создаем и настраиваем права доступа
    UserPermissionEntity permissions = new UserPermissionEntity();
    permissions.setUser(entity);
    
    // Если пользователь root, то все права доступа включены
    if (entity.getIsRoot()) {
        permissions.setCanManageUsers(true);
        permissions.setCanManageServices(true);
        permissions.setCanManageCategories(true);
        permissions.setCanManageVisitObjects(true);
        permissions.setCanViewReports(true);
        permissions.setCanManageSettings(true);
        permissions.setCanManageOrders(true);
        permissions.setCanExportData(true);
        permissions.setCanImportData(true);
    } else if (dto.getPermissions() != null) {
        // Иначе устанавливаем права из DTO
        permissions.setCanManageUsers(dto.getPermissions().getCanManageUsers() != null && dto.getPermissions().getCanManageUsers());
        permissions.setCanManageServices(dto.getPermissions().getCanManageServices() != null && dto.getPermissions().getCanManageServices());
        permissions.setCanManageCategories(dto.getPermissions().getCanManageCategories() != null && dto.getPermissions().getCanManageCategories());
        permissions.setCanManageVisitObjects(dto.getPermissions().getCanManageVisitObjects() != null && dto.getPermissions().getCanManageVisitObjects());
        permissions.setCanViewReports(dto.getPermissions().getCanViewReports() != null && dto.getPermissions().getCanViewReports());
        permissions.setCanManageSettings(dto.getPermissions().getCanManageSettings() != null && dto.getPermissions().getCanManageSettings());
        permissions.setCanManageOrders(dto.getPermissions().getCanManageOrders() != null && dto.getPermissions().getCanManageOrders());
        permissions.setCanExportData(dto.getPermissions().getCanExportData() != null && dto.getPermissions().getCanExportData());
        permissions.setCanImportData(dto.getPermissions().getCanImportData() != null && dto.getPermissions().getCanImportData());
    }
    
    entity.setPermissions(permissions);
}
